<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1400 1000">
  <defs>
    <linearGradient id="orgGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#f59e0b"/>
      <stop offset="100%" style="stop-color:#d97706"/>
    </linearGradient>
    <linearGradient id="userGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#3b82f6"/>
      <stop offset="100%" style="stop-color:#2563eb"/>
    </linearGradient>
    <linearGradient id="groupGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#06b6d4"/>
      <stop offset="100%" style="stop-color:#0891b2"/>
    </linearGradient>
    <linearGradient id="licenseGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#ef4444"/>
      <stop offset="100%" style="stop-color:#dc2626"/>
    </linearGradient>
    <linearGradient id="headerGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#7c3aed"/>
      <stop offset="50%" style="stop-color:#8b5cf6"/>
      <stop offset="100%" style="stop-color:#7c3aed"/>
    </linearGradient>
    <filter id="shadow" x="-10%" y="-10%" width="120%" height="120%">
      <feDropShadow dx="3" dy="3" stdDeviation="5" flood-opacity="0.25"/>
    </filter>
    <marker id="arrow" markerWidth="12" markerHeight="8" refX="10" refY="4" orient="auto">
      <polygon points="0 0, 12 4, 0 8" fill="#64748b"/>
    </marker>
    <marker id="arrow-dashed" markerWidth="12" markerHeight="8" refX="10" refY="4" orient="auto">
      <polygon points="0 0, 12 4, 0 8" fill="#8b5cf6"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="1400" height="1000" fill="#f8fafc"/>
  <pattern id="dots" width="20" height="20" patternUnits="userSpaceOnUse">
    <circle cx="2" cy="2" r="1" fill="#e2e8f0"/>
  </pattern>
  <rect width="1400" height="1000" fill="url(#dots)"/>

  <!-- Title -->
  <rect x="0" y="0" width="1400" height="70" fill="url(#headerGrad)"/>
  <text x="700" y="35" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="28" font-weight="bold">Organization &amp; User Structure</text>
  <text x="700" y="55" text-anchor="middle" fill="#c4b5fd" font-family="Arial, sans-serif" font-size="14">How Organizations, Users, Groups &amp; Licenses are Connected</text>

  <!-- ==================== MAIN VISUALIZATION ==================== -->

  <!-- ORGANIZATION (account type=1) -->
  <g transform="translate(500, 100)" filter="url(#shadow)">
    <rect width="400" height="120" rx="15" fill="url(#orgGrad)"/>
    <rect x="10" y="10" width="380" height="100" rx="12" fill="white" fill-opacity="0.15"/>

    <!-- Building icon -->
    <g transform="translate(30, 25)">
      <rect x="0" y="20" width="50" height="50" fill="white" rx="3"/>
      <rect x="5" y="25" width="8" height="8" fill="#d97706"/>
      <rect x="17" y="25" width="8" height="8" fill="#d97706"/>
      <rect x="29" y="25" width="8" height="8" fill="#d97706"/>
      <rect x="5" y="38" width="8" height="8" fill="#d97706"/>
      <rect x="17" y="38" width="8" height="8" fill="#d97706"/>
      <rect x="29" y="38" width="8" height="8" fill="#d97706"/>
      <rect x="5" y="51" width="8" height="8" fill="#d97706"/>
      <rect x="17" y="51" width="8" height="8" fill="#d97706"/>
      <rect x="29" y="51" width="8" height="8" fill="#d97706"/>
      <rect x="17" y="10" width="16" height="10" fill="white" rx="2"/>
    </g>

    <text x="100" y="45" fill="white" font-family="Arial" font-size="22" font-weight="bold">ORGANIZATION</text>
    <text x="100" y="70" fill="white" font-family="Arial" font-size="14">account table (type = 1)</text>
    <text x="100" y="90" fill="#fef3c7" font-family="Consolas" font-size="12">name: "Acme Corp"  |  domain: "acme.com"</text>

    <!-- Type badge -->
    <rect x="320" y="20" width="60" height="25" rx="12" fill="white"/>
    <text x="350" y="37" text-anchor="middle" fill="#d97706" font-family="Arial" font-size="11" font-weight="bold">type=1</text>
  </g>

  <!-- Connector lines from org to members/groups/licenses -->
  <path d="M 700 220 L 700 270 L 300 270 L 300 320" stroke="#64748b" stroke-width="3" fill="none"/>
  <path d="M 700 220 L 700 270 L 700 320" stroke="#64748b" stroke-width="3" fill="none"/>
  <path d="M 700 220 L 700 270 L 1100 270 L 1100 320" stroke="#64748b" stroke-width="3" fill="none"/>

  <text x="300" y="295" text-anchor="middle" fill="#64748b" font-family="Arial" font-size="11" font-weight="bold">MEMBERS</text>
  <text x="700" y="295" text-anchor="middle" fill="#64748b" font-family="Arial" font-size="11" font-weight="bold">GROUPS</text>
  <text x="1100" y="295" text-anchor="middle" fill="#64748b" font-family="Arial" font-size="11" font-weight="bold">LICENSES</text>

  <!-- ==================== ACCOUNT_MEMBER Section ==================== -->
  <g transform="translate(50, 330)">
    <rect width="500" height="280" rx="15" fill="#ede9fe" stroke="#8b5cf6" stroke-width="2" filter="url(#shadow)"/>
    <rect width="500" height="40" rx="15" fill="#8b5cf6"/>
    <text x="250" y="27" text-anchor="middle" fill="white" font-family="Arial" font-size="16" font-weight="bold">account_member (User-Org Link)</text>

    <!-- Explanation -->
    <text x="20" y="60" fill="#5b21b6" font-family="Arial" font-size="12" font-weight="bold">Links individual users to organizations via their account IDs</text>

    <!-- User accounts linked to org -->
    <g transform="translate(20, 80)">
      <!-- Admin User -->
      <g transform="translate(0, 0)">
        <rect width="220" height="90" rx="10" fill="white" stroke="#22c55e" stroke-width="2"/>
        <rect width="220" height="30" rx="10" fill="#22c55e"/>
        <text x="110" y="20" text-anchor="middle" fill="white" font-family="Arial" font-size="12" font-weight="bold">Admin User</text>

        <g transform="translate(10, 40)" font-family="Consolas" font-size="10">
          <text fill="#334155">identity.id: 101</text>
          <text y="14" fill="#334155">identity.account_id: 1001</text>
          <text y="28" fill="#22c55e" font-weight="bold">identity.role: 1 (admin)</text>
          <text y="42" fill="#64748b">email: admin@acme.com</text>
        </g>

        <!-- Link indicator -->
        <circle cx="220" cy="45" r="8" fill="#8b5cf6"/>
        <text x="220" y="49" text-anchor="middle" fill="white" font-family="Arial" font-size="10" font-weight="bold">1</text>
      </g>

      <!-- Normal User 1 -->
      <g transform="translate(250, 0)">
        <rect width="220" height="90" rx="10" fill="white" stroke="#3b82f6" stroke-width="2"/>
        <rect width="220" height="30" rx="10" fill="#3b82f6"/>
        <text x="110" y="20" text-anchor="middle" fill="white" font-family="Arial" font-size="12" font-weight="bold">Normal User</text>

        <g transform="translate(10, 40)" font-family="Consolas" font-size="10">
          <text fill="#334155">identity.id: 102</text>
          <text y="14" fill="#334155">identity.account_id: 1002</text>
          <text y="28" fill="#3b82f6" font-weight="bold">identity.role: 0 (user)</text>
          <text y="42" fill="#64748b">email: john@acme.com</text>
        </g>

        <circle cx="220" cy="45" r="8" fill="#8b5cf6"/>
        <text x="220" y="49" text-anchor="middle" fill="white" font-family="Arial" font-size="10" font-weight="bold">0</text>
      </g>
    </g>

    <!-- account_member records visualization -->
    <g transform="translate(20, 190)">
      <rect width="460" height="70" rx="8" fill="#f5f3ff" stroke="#c4b5fd"/>
      <text x="230" y="20" text-anchor="middle" fill="#7c3aed" font-family="Arial" font-size="12" font-weight="bold">account_member records</text>

      <g transform="translate(10, 30)" font-family="Consolas" font-size="10">
        <rect width="210" height="30" fill="white" rx="4"/>
        <text x="10" y="18" fill="#334155">account_id: 1000 (org)</text>
        <text x="10" y="28" fill="#334155">member_id: 1001, member_role: <tspan fill="#22c55e" font-weight="bold">1</tspan></text>

        <rect x="230" y="0" width="210" height="30" fill="white" rx="4"/>
        <text x="240" y="18" fill="#334155">account_id: 1000 (org)</text>
        <text x="240" y="28" fill="#334155">member_id: 1002, member_role: <tspan fill="#3b82f6" font-weight="bold">0</tspan></text>
      </g>
    </g>
  </g>

  <!-- ==================== GROUPS Section ==================== -->
  <g transform="translate(570, 330)">
    <rect width="260" height="280" rx="15" fill="#cffafe" stroke="#06b6d4" stroke-width="2" filter="url(#shadow)"/>
    <rect width="260" height="40" rx="15" fill="#06b6d4"/>
    <text x="130" y="27" text-anchor="middle" fill="white" font-family="Arial" font-size="16" font-weight="bold">Groups</text>

    <!-- Group A -->
    <g transform="translate(20, 60)">
      <rect width="220" height="90" rx="10" fill="white" stroke="#0891b2" stroke-width="2"/>
      <rect width="220" height="28" rx="10" fill="#0891b2"/>
      <text x="110" y="19" text-anchor="middle" fill="white" font-family="Arial" font-size="12" font-weight="bold">Development Team</text>

      <g transform="translate(10, 35)" font-family="Consolas" font-size="10">
        <text fill="#334155">account_group.id: 1</text>
        <text y="14" fill="#334155">account_group.account_id: 1000</text>
        <text y="28" fill="#64748b">name: "Development Team"</text>
      </g>

      <!-- Members dots -->
      <g transform="translate(140, 55)">
        <circle cx="0" cy="0" r="10" fill="#22c55e"/><text x="0" y="4" text-anchor="middle" fill="white" font-size="8">A</text>
        <circle cx="25" cy="0" r="10" fill="#3b82f6"/><text x="25" y="4" text-anchor="middle" fill="white" font-size="8">J</text>
      </g>
    </g>

    <!-- Group B -->
    <g transform="translate(20, 165)">
      <rect width="220" height="90" rx="10" fill="white" stroke="#0891b2" stroke-width="2"/>
      <rect width="220" height="28" rx="10" fill="#0891b2"/>
      <text x="110" y="19" text-anchor="middle" fill="white" font-family="Arial" font-size="12" font-weight="bold">Sales Team</text>

      <g transform="translate(10, 35)" font-family="Consolas" font-size="10">
        <text fill="#334155">account_group.id: 2</text>
        <text y="14" fill="#334155">account_group.account_id: 1000</text>
        <text y="28" fill="#64748b">name: "Sales Team"</text>
      </g>

      <g transform="translate(165, 55)">
        <circle cx="0" cy="0" r="10" fill="#3b82f6"/><text x="0" y="4" text-anchor="middle" fill="white" font-size="8">S</text>
      </g>
    </g>
  </g>

  <!-- ==================== LICENSES Section ==================== -->
  <g transform="translate(850, 330)">
    <rect width="300" height="280" rx="15" fill="#fee2e2" stroke="#ef4444" stroke-width="2" filter="url(#shadow)"/>
    <rect width="300" height="40" rx="15" fill="#ef4444"/>
    <text x="150" y="27" text-anchor="middle" fill="white" font-family="Arial" font-size="16" font-weight="bold">Licenses (Owned by Org)</text>

    <!-- License 1 -->
    <g transform="translate(20, 55)">
      <rect width="260" height="100" rx="10" fill="white" stroke="#dc2626" stroke-width="2"/>
      <rect width="260" height="28" rx="10" fill="#dc2626"/>
      <text x="130" y="19" text-anchor="middle" fill="white" font-family="Arial" font-size="12" font-weight="bold">Enterprise License</text>

      <g transform="translate(10, 35)" font-family="Consolas" font-size="10">
        <text fill="#334155">license.id: 5001</text>
        <text y="14" fill="#334155">license.owner_id: <tspan fill="#dc2626" font-weight="bold">1000</tspan> (org)</text>
        <text y="28" fill="#334155">product: "ProSoftware"</text>
        <text y="42" fill="#334155">seat_limit: 50 | type: floating</text>
        <text y="56" fill="#64748b">expiry: 2025-12-31</text>
      </g>
    </g>

    <!-- License 2 -->
    <g transform="translate(20, 170)">
      <rect width="260" height="90" rx="10" fill="white" stroke="#dc2626" stroke-width="2"/>
      <rect width="260" height="28" rx="10" fill="#dc2626"/>
      <text x="130" y="19" text-anchor="middle" fill="white" font-family="Arial" font-size="12" font-weight="bold">Team License</text>

      <g transform="translate(10, 35)" font-family="Consolas" font-size="10">
        <text fill="#334155">license.id: 5002</text>
        <text y="14" fill="#334155">license.owner_id: <tspan fill="#dc2626" font-weight="bold">1000</tspan> (org)</text>
        <text y="28" fill="#334155">product: "DevTools"</text>
        <text y="42" fill="#334155">seat_limit: 10 | type: named</text>
      </g>
    </g>
  </g>

  <!-- ==================== Individual User (Not in Org) ==================== -->
  <g transform="translate(50, 650)">
    <rect width="350" height="150" rx="15" fill="#dbeafe" stroke="#3b82f6" stroke-width="2" filter="url(#shadow)"/>
    <rect width="350" height="40" rx="15" fill="#3b82f6"/>
    <text x="175" y="27" text-anchor="middle" fill="white" font-family="Arial" font-size="16" font-weight="bold">Individual User (No Org)</text>

    <g transform="translate(20, 55)">
      <rect width="310" height="80" rx="10" fill="white" stroke="#60a5fa"/>

      <g transform="translate(15, 20)" font-family="Consolas" font-size="11">
        <text fill="#1e40af" font-weight="bold">account table (type = 0)</text>
        <text y="18" fill="#334155">id: 2000 | name: "solo@email.com"</text>
        <text y="36" fill="#1e40af" font-weight="bold">identity table</text>
        <text y="54" fill="#334155">id: 201 | account_id: 2000 | role: 0</text>
      </g>
    </g>

    <text x="175" y="140" text-anchor="middle" fill="#3b82f6" font-family="Arial" font-size="11" font-style="italic">No account_member record - not linked to any org</text>
  </g>

  <!-- ==================== SuperAdmin ==================== -->
  <g transform="translate(420, 650)">
    <rect width="300" height="150" rx="15" fill="#fce7f3" stroke="#ec4899" stroke-width="2" filter="url(#shadow)"/>
    <rect width="300" height="40" rx="15" fill="#ec4899"/>
    <text x="150" y="27" text-anchor="middle" fill="white" font-family="Arial" font-size="16" font-weight="bold">SuperAdmin (role=2)</text>

    <g transform="translate(20, 55)">
      <rect width="260" height="80" rx="10" fill="white" stroke="#f472b6"/>

      <g transform="translate(15, 20)" font-family="Consolas" font-size="11">
        <text fill="#9d174d" font-weight="bold">identity table</text>
        <text y="18" fill="#334155">id: 1 | account_id: 999</text>
        <text y="36" fill="#ec4899" font-weight="bold">role: 2 (superadmin)</text>
        <text y="54" fill="#64748b">Can see ALL organizations &amp; licenses</text>
      </g>
    </g>
  </g>

  <!-- ==================== How it works explanation ==================== -->
  <g transform="translate(740, 650)">
    <rect width="420" height="150" rx="15" fill="white" stroke="#64748b" stroke-width="2" filter="url(#shadow)"/>
    <rect width="420" height="40" rx="15" fill="#475569"/>
    <text x="210" y="27" text-anchor="middle" fill="white" font-family="Arial" font-size="16" font-weight="bold">How Data Access Works</text>

    <g transform="translate(20, 55)" font-family="Arial" font-size="12">
      <circle cx="8" cy="6" r="6" fill="#3b82f6"/>
      <text x="22" y="10" fill="#334155"><tspan font-weight="bold" fill="#3b82f6">role=0 (User):</tspan> Sees own account data only</text>

      <circle cx="8" cy="30" r="6" fill="#22c55e"/>
      <text x="22" y="34" fill="#334155"><tspan font-weight="bold" fill="#22c55e">role=1 (Admin):</tspan> Sees org data via account_member</text>

      <circle cx="8" cy="54" r="6" fill="#ec4899"/>
      <text x="22" y="58" fill="#334155"><tspan font-weight="bold" fill="#ec4899">role=2 (Super):</tspan> Sees ALL data in the system</text>

      <text x="0" y="82" fill="#64748b" font-size="11" font-style="italic">Admin rights determined by: account_member.member_role = 1</text>
    </g>
  </g>

  <!-- ==================== Legend at bottom ==================== -->
  <g transform="translate(50, 830)">
    <rect width="1300" height="130" rx="15" fill="#f1f5f9" stroke="#cbd5e1" filter="url(#shadow)"/>
    <rect width="1300" height="35" rx="15" fill="#64748b"/>
    <text x="650" y="24" text-anchor="middle" fill="white" font-family="Arial" font-size="14" font-weight="bold">DATA STRUCTURE SUMMARY</text>

    <g transform="translate(30, 50)">
      <!-- Account Types -->
      <rect width="250" height="65" rx="8" fill="white" stroke="#e2e8f0"/>
      <text x="125" y="18" text-anchor="middle" fill="#334155" font-family="Arial" font-size="12" font-weight="bold">account.type</text>
      <text x="15" y="38" fill="#334155" font-family="Consolas" font-size="11">0 = Individual user</text>
      <text x="15" y="53" fill="#334155" font-family="Consolas" font-size="11">1 = Organization</text>

      <!-- Identity Roles -->
      <g transform="translate(280, 0)">
        <rect width="280" height="65" rx="8" fill="white" stroke="#e2e8f0"/>
        <text x="140" y="18" text-anchor="middle" fill="#334155" font-family="Arial" font-size="12" font-weight="bold">identity.role</text>
        <text x="15" y="38" fill="#3b82f6" font-family="Consolas" font-size="11">0 = Normal User</text>
        <text x="15" y="53" fill="#22c55e" font-family="Consolas" font-size="11">1 = Admin</text>
        <text x="150" y="53" fill="#ec4899" font-family="Consolas" font-size="11">2 = SuperAdmin</text>
      </g>

      <!-- Member Roles -->
      <g transform="translate(590, 0)">
        <rect width="280" height="65" rx="8" fill="white" stroke="#e2e8f0"/>
        <text x="140" y="18" text-anchor="middle" fill="#334155" font-family="Arial" font-size="12" font-weight="bold">account_member.member_role</text>
        <text x="15" y="38" fill="#3b82f6" font-family="Consolas" font-size="11">0 = Normal member</text>
        <text x="15" y="53" fill="#22c55e" font-family="Consolas" font-size="11">1 = Organization Admin</text>
      </g>

      <!-- Key Tables -->
      <g transform="translate(900, 0)">
        <rect width="360" height="65" rx="8" fill="white" stroke="#e2e8f0"/>
        <text x="180" y="18" text-anchor="middle" fill="#334155" font-family="Arial" font-size="12" font-weight="bold">Key Relationships</text>
        <text x="15" y="38" fill="#334155" font-family="Arial" font-size="10">identity.account_id --> account.id</text>
        <text x="15" y="53" fill="#334155" font-family="Arial" font-size="10">account_member links user accounts to org accounts</text>
      </g>
    </g>
  </g>

  <!-- Footer -->
  <text x="700" y="980" text-anchor="middle" fill="#94a3b8" font-family="Arial, sans-serif" font-size="11">License Management System - Organization Structure | Generated 2025</text>

</svg>